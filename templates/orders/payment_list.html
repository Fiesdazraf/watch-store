{% extends "base.html" %}
{% load humanize %}
{% block title %}ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øªâ€ŒÙ‡Ø§ | ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø³Ø§Ø¹Øª{% endblock %}

{% block content %}
<section class="section pt-5">
  <div class="container">

    <h1 class="title is-4 mb-5">ğŸ’³ ØªØ§Ø±ÛŒØ®Ú†Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øªâ€ŒÙ‡Ø§</h1>

    {% if payments %}
      <div class="table-container">
        <table class="table is-fullwidth is-striped is-hoverable">
          <thead class="has-background-light">
            <tr>
              <th>Ø´Ù…Ø§Ø±Ù‡ Ø³ÙØ§Ø±Ø´</th>
              <th class="has-text-centered">Ù…Ø¨Ù„Øº</th>
              <th class="has-text-centered">ÙˆØ§Ø­Ø¯</th>
              <th class="has-text-centered">Ø±ÙˆØ´ Ù¾Ø±Ø¯Ø§Ø®Øª</th>
              <th class="has-text-centered">ÙˆØ¶Ø¹ÛŒØª</th>
              <th class="has-text-centered">ØªØ§Ø±ÛŒØ®</th>
              <th class="has-text-centered">Ø´Ù†Ø§Ø³Ù‡ ØªØ±Ø§Ú©Ù†Ø´</th>
              <th class="has-text-centered">Ø¹Ù…Ù„ÛŒØ§Øª</th>
            </tr>
          </thead>
          <tbody>
            {% for p in payments %}
            <tr>
              <td>
                <a href="{% url 'orders:order_detail' p.order.number %}" class="has-text-weight-semibold">
                  #{{ p.order.number }}
                </a>
              </td>

              <td class="has-text-centered has-text-weight-semibold">
                {{ p.amount|intcomma }} ØªÙˆÙ…Ø§Ù†
              </td>

              <td class="has-text-centered">{{ p.currency|default:"IRR" }}</td>

              <td class="has-text-centered">{{ p.get_method_display|default:"-" }}</td>

              <td class="has-text-centered">
                <span class="tag is-light
                  {% if p.status == 'success' or p.status == 'succeeded' %}is-success
                  {% elif p.status == 'failed' %}is-danger
                  {% elif p.status == 'canceled' %}is-warning
                  {% elif p.status == 'processing' %}is-info
                  {% else %}is-light{% endif %}">
                  {{ p.get_status_display }}
                </span>
              </td>

              <td class="has-text-centered">{{ p.created_at|date:"Y-m-d H:i" }}</td>

              <td class="has-text-centered">
                <code>{{ p.transaction_id|default:"â€”" }}</code>
              </td>

              <td class="has-text-centered">
                <a href="{% url 'orders:order_detail' p.order.number %}"
                   class="button is-small is-link is-light">
                  <span class="icon"><i class="fas fa-eye"></i></span>
                  <span>Ø¬Ø²Ø¦ÛŒØ§Øª Ø³ÙØ§Ø±Ø´</span>
                </a>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      {% if payments.has_other_pages %}
        <nav class="pagination is-centered mt-5" role="navigation" aria-label="pagination">
          {% if payments.has_previous %}
            <a class="pagination-previous" href="?page={{ payments.previous_page_number }}">Ù‚Ø¨Ù„ÛŒ</a>
          {% else %}
            <span class="pagination-previous is-disabled">Ù‚Ø¨Ù„ÛŒ</span>
          {% endif %}
          {% if payments.has_next %}
            <a class="pagination-next" href="?page={{ payments.next_page_number }}">Ø¨Ø¹Ø¯ÛŒ</a>
          {% else %}
            <span class="pagination-next is-disabled">Ø¨Ø¹Ø¯ÛŒ</span>
          {% endif %}
          <ul class="pagination-list">
            {% for i in payments.paginator.page_range %}
              {% if i == payments.number %}
                <li><a class="pagination-link is-current">{{ i }}</a></li>
              {% else %}
                <li><a class="pagination-link" href="?page={{ i }}">{{ i }}</a></li>
              {% endif %}
            {% endfor %}
          </ul>
        </nav>
      {% endif %}

    {% else %}
      <div class="notification is-light is-info has-text-centered py-6">
        <p class="is-size-5 mb-3">Ù‡ÛŒÚ† Ù¾Ø±Ø¯Ø§Ø®ØªÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª ğŸ’³</p>
        <a href="{% url 'catalog:product_list' %}" class="button is-link is-light">
          Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ÙØ±ÙˆØ´Ú¯Ø§Ù‡
        </a>
      </div>
    {% endif %}

    <div class="buttons mt-6">
      <a href="{% url 'orders:order_history' %}" class="button is-light">
        <span class="icon"><i class="fas fa-list"></i></span>
        <span>Ø³ÙˆØ§Ø¨Ù‚ Ø³ÙØ§Ø±Ø´â€ŒÙ‡Ø§</span>
      </a>
      <a href="{% url 'catalog:product_list' %}" class="button is-link is-light">
        <span class="icon"><i class="fas fa-shopping-bag"></i></span>
        <span>Ø§Ø¯Ø§Ù…Ù‡ Ø®Ø±ÛŒØ¯</span>
      </a>
    </div>

  </div>
</section>
{% endblock %}
