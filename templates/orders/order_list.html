{% extends "base.html" %}
{% load humanize %}
{% block title %}Ø³ÙØ§Ø±Ø´â€ŒÙ‡Ø§ÛŒ Ù…Ù† | ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø³Ø§Ø¹Øª{% endblock %}

{% block content %}
<section class="section pt-5">
  <div class="container">

    <h1 class="title is-4 mb-5">ğŸ§¾ Ø³ÙØ§Ø±Ø´â€ŒÙ‡Ø§ÛŒ Ù…Ù†</h1>

    {% if orders and orders.object_list %}
      <div class="table-container">
        <table class="table is-fullwidth is-striped is-hoverable">
          <thead class="has-background-light">
            <tr>
              <th>Ø´Ù…Ø§Ø±Ù‡ Ø³ÙØ§Ø±Ø´</th>
              <th class="has-text-centered">ÙˆØ¶Ø¹ÛŒØª</th>
              <th class="has-text-centered">Ù…Ø¨Ù„Øº Ù†Ù‡Ø§ÛŒÛŒ</th>
              <th class="has-text-centered">ØªØ§Ø±ÛŒØ® Ø«Ø¨Øª</th>
              <th class="has-text-centered">Ø¹Ù…Ù„ÛŒØ§Øª</th>
            </tr>
          </thead>
          <tbody>
            {% for o in orders %}
              {% with p=o.payment_obj %}
              <tr>
                <!-- Ø´Ù…Ø§Ø±Ù‡ Ø³ÙØ§Ø±Ø´ -->
                <td>
                  <a href="{% url 'orders:order_detail' o.number %}" class="has-text-weight-semibold">
                    #{{ o.number }}
                  </a>
                  {% if p and p.method %}
                    <span class="tag is-light is-rounded is-size-7 ml-2">
                      {{ p.method.name|default:"-" }}
                    </span>
                  {% endif %}
                </td>

                <!-- ÙˆØ¶Ø¹ÛŒØª Ù¾Ø±Ø¯Ø§Ø®Øª -->
                <td class="has-text-centered">
                  {% if o.is_paid %}
                    <span class="tag is-success is-light">Ù¾Ø±Ø¯Ø§Ø®Øªâ€ŒØ´Ø¯Ù‡</span>
                  {% elif p and p.status == "failed" %}
                    <span class="tag is-danger is-light">Ù¾Ø±Ø¯Ø§Ø®Øª Ù†Ø§Ù…ÙˆÙÙ‚</span>
                  {% else %}
                    <span class="tag is-warning is-light">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± Ù¾Ø±Ø¯Ø§Ø®Øª</span>
                  {% endif %}
                </td>

                <!-- Ù…Ø¨Ù„Øº -->
                <td class="has-text-centered has-text-weight-semibold">
                  {{ o.grand_total|intcomma }} ØªÙˆÙ…Ø§Ù†
                </td>

                <!-- ØªØ§Ø±ÛŒØ® -->
                <td class="has-text-centered">
                  {{ o.placed_at|date:"Y-m-d H:i" }}
                </td>

                <!-- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ -->
                <td class="has-text-centered">
                  <a href="{% url 'orders:order_detail' o.number %}"
                     class="button is-small is-link is-light">
                    <span class="icon"><i class="fas fa-eye"></i></span>
                    <span>Ù…Ø´Ø§Ù‡Ø¯Ù‡</span>
                  </a>
                  {% if not o.is_paid %}
                    <a href="{{ o.get_checkout_payment_url }}"
                       class="button is-small is-primary ml-1">
                      <span class="icon"><i class="fas fa-credit-card"></i></span>
                      <span>Ù¾Ø±Ø¯Ø§Ø®Øª</span>
                    </a>
                  {% endif %}
                </td>
              </tr>
              {% endwith %}
            {% endfor %}
          </tbody>
        </table>
      </div>

      <!-- Pagination -->
      {% if orders.has_other_pages %}
        <nav class="pagination is-centered mt-5" role="navigation" aria-label="pagination">
          {% if orders.has_previous %}
            <a class="pagination-previous" href="?page={{ orders.previous_page_number }}">Ù‚Ø¨Ù„ÛŒ</a>
          {% else %}
            <span class="pagination-previous is-disabled">Ù‚Ø¨Ù„ÛŒ</span>
          {% endif %}

          {% if orders.has_next %}
            <a class="pagination-next" href="?page={{ orders.next_page_number }}">Ø¨Ø¹Ø¯ÛŒ</a>
          {% else %}
            <span class="pagination-next is-disabled">Ø¨Ø¹Ø¯ÛŒ</span>
          {% endif %}

          <ul class="pagination-list">
            {% for i in orders.paginator.page_range %}
              {% if i == orders.number %}
                <li><a class="pagination-link is-current">{{ i }}</a></li>
              {% else %}
                <li><a class="pagination-link" href="?page={{ i }}">{{ i }}</a></li>
              {% endif %}
            {% endfor %}
          </ul>
        </nav>
      {% endif %}

    {% else %}
      <div class="notification is-light is-info has-text-centered py-6">
        <p class="is-size-5 mb-3">Ù‡ÛŒÚ† Ø³ÙØ§Ø±Ø´ÛŒ Ø«Ø¨Øª Ù†Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯ ğŸ“­</p>
        <a href="{% url 'catalog:product_list' %}" class="button is-link is-light">
          Ø±ÙØªÙ† Ø¨Ù‡ ÙØ±ÙˆØ´Ú¯Ø§Ù‡
        </a>
      </div>
    {% endif %}

  </div>
</section>
{% endblock %}
