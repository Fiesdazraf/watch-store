{% extends "base.html" %}
{% load static humanize %}
{% block title %}ØªØ³ÙˆÛŒÙ‡â€ŒØ­Ø³Ø§Ø¨ | ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø³Ø§Ø¹Øª{% endblock %}

{% block content %}
<section class="section pt-5">
  <div class="container">
    <h1 class="title is-4 mb-5 has-text-centered">ğŸ’³ ØªØ³ÙˆÛŒÙ‡â€ŒØ­Ø³Ø§Ø¨</h1>

    {% if items %}
    <div class="columns is-variable is-6">
      
      <!-- ğŸ› Ø®Ù„Ø§ØµÙ‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ -->
      <div class="column is-5">
        <div class="box">
          <h2 class="title is-5 mb-4 has-text-centered">Ø®Ù„Ø§ØµÙ‡ Ø³ÙØ§Ø±Ø´</h2>

          <table class="table is-fullwidth is-striped is-narrow">
            <thead>
              <tr>
                <th>Ù…Ø­ØµÙˆÙ„</th>
                <th class="has-text-centered">ØªØ¹Ø¯Ø§Ø¯</th>
                <th class="has-text-right">Ù‚ÛŒÙ…Øª</th>
              </tr>
            </thead>
            <tbody>
              {% for it in items %}
              <tr>
                <td>
                  <div class="is-flex is-align-items-center">
                    {% if it.product.primary_image %}
                      <figure class="image is-48x48 ml-3">
                        <img src="{{ it.product.primary_image.url }}" alt="{{ it.product.title }}">
                      </figure>
                    {% endif %}
                    <div>
                      <strong>{{ it.product.title }}</strong>
                      {% if it.variant_display %}
                        <div class="is-size-7 has-text-grey">({{ it.variant_display }})</div>
                      {% endif %}
                    </div>
                  </div>
                </td>
                <td class="has-text-centered">{{ it.quantity }}</td>
                <td class="has-text-right">{{ it.subtotal|intcomma }} ØªÙˆÙ…Ø§Ù†</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>

          <hr class="my-3">

          <div class="is-flex is-justify-content-space-between mb-2">
            <span>Ø¬Ù…Ø¹ Ø¬Ø²Ø¡:</span>
            <strong>{{ subtotal|intcomma }} ØªÙˆÙ…Ø§Ù†</strong>
          </div>
          {% if shipping_cost %}
          <div class="is-flex is-justify-content-space-between mb-2">
            <span>Ù‡Ø²ÛŒÙ†Ù‡ Ø§Ø±Ø³Ø§Ù„:</span>
            <strong>{{ shipping_cost|intcomma }} ØªÙˆÙ…Ø§Ù†</strong>
          </div>
          {% endif %}
          {% if discount_total %}
          <div class="is-flex is-justify-content-space-between mb-2 has-text-danger">
            <span>ØªØ®ÙÛŒÙ:</span>
            <strong>-{{ discount_total|intcomma }} ØªÙˆÙ…Ø§Ù†</strong>
          </div>
          {% endif %}
          <hr class="my-2">
          <div class="is-flex is-justify-content-space-between">
            <span>Ù…Ø¨Ù„Øº Ù†Ù‡Ø§ÛŒÛŒ:</span>
            <strong class="has-text-weight-bold has-text-primary">
              {{ total|intcomma }} ØªÙˆÙ…Ø§Ù†
            </strong>
          </div>
        </div>
      </div>

      <!-- ğŸšš ÙØ±Ù… ØªØ³ÙˆÛŒÙ‡ Ø­Ø³Ø§Ø¨ -->
      <div class="column is-7">
        <div class="box">
          <h2 class="title is-5 mb-4 has-text-centered">Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø§Ø±Ø³Ø§Ù„ Ùˆ Ù¾Ø±Ø¯Ø§Ø®Øª</h2>
          <form method="post" novalidate>
            {% csrf_token %}

            <!-- Ø¢Ø¯Ø±Ø³ Ú©Ø§Ø±Ø¨Ø± -->
            <div class="field mb-5">
              <label class="label">Ø§Ù†ØªØ®Ø§Ø¨ Ø¢Ø¯Ø±Ø³</label>
              {% if addresses %}
                <div class="box p-4">
                  {% for addr in addresses %}
                    <label class="radio block mb-2">
                      <input type="radio" name="address_id" value="{{ addr.id }}"
                        {% if addr.id == default_address_id %}checked{% endif %}>
                      <span class="has-text-weight-medium">{{ addr.full_name }}</span>
                      â€” {{ addr.line1 }}, {{ addr.city }}
                      {% if addr.default_shipping %}
                        <span class="tag is-info is-light ml-2">Ù¾ÛŒØ´â€ŒÙØ±Ø¶</span>
                      {% endif %}
                    </label>
                  {% endfor %}
                </div>

                <div class="field mt-2">
                  <a href="{% url 'customers:address_list' %}" class="button is-small is-link is-light">
                    <span class="icon"><i class="fas fa-map-marker-alt"></i></span>
                    <span>Ù…Ø¯ÛŒØ±ÛŒØª Ø¢Ø¯Ø±Ø³â€ŒÙ‡Ø§</span>
                  </a>
                </div>
              {% else %}
                <article class="message is-warning is-light">
                  <div class="message-body">
                    Ù‡Ù†ÙˆØ² Ø¢Ø¯Ø±Ø³ÛŒ Ø«Ø¨Øª Ù†Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯.
                    <a href="{% url 'customers:address_list' %}" class="button is-small is-link ml-2">Ø§ÙØ²ÙˆØ¯Ù† Ø¢Ø¯Ø±Ø³</a>
                  </div>
                </article>
              {% endif %}
            </div>

            <!-- Ø±ÙˆØ´ Ø§Ø±Ø³Ø§Ù„ -->
            <div class="field mb-4">
              <label class="label">Ø±ÙˆØ´ Ø§Ø±Ø³Ø§Ù„</label>
              <div class="control">{{ form.shipping_method }}</div>
              {% for e in form.shipping_method.errors %}
                <p class="help is-danger">{{ e }}</p>
              {% endfor %}
            </div>

            <!-- Ø±ÙˆØ´ Ù¾Ø±Ø¯Ø§Ø®Øª -->
            <div class="field mb-4">
              <label class="label">Ø±ÙˆØ´ Ù¾Ø±Ø¯Ø§Ø®Øª</label>
              <div class="control">{{ form.payment_method }}</div>
              {% for e in form.payment_method.errors %}
                <p class="help is-danger">{{ e }}</p>
              {% endfor %}
            </div>

            <!-- ÛŒØ§Ø¯Ø¯Ø§Ø´Øª -->
            <div class="field mb-5">
              <label class="label">ÛŒØ§Ø¯Ø¯Ø§Ø´Øª (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)</label>
              <div class="control">{{ form.notes }}</div>
            </div>

            <!-- Ø¯Ú©Ù…Ù‡ Ø«Ø¨Øª Ø³ÙØ§Ø±Ø´ -->
            <div class="field mt-5">
              <div class="control">
                <button class="button is-primary is-fullwidth is-medium" type="submit">
                  <span class="icon"><i class="fas fa-check-circle"></i></span>
                  <span>Ø«Ø¨Øª Ø³ÙØ§Ø±Ø´ Ùˆ Ø§Ø¯Ø§Ù…Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª</span>
                </button>
              </div>
            </div>
          </form>
        </div>
      </div>

    </div>
    {% else %}
      <div class="notification is-warning has-text-centered py-6">
        <p class="is-size-5 mb-3">Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø´Ù…Ø§ Ø®Ø§Ù„ÛŒ Ø§Ø³Øª ğŸ˜•</p>
        <a href="{% url 'catalog:product_list' %}" class="button is-link is-light">Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ÙØ±ÙˆØ´Ú¯Ø§Ù‡</a>
      </div>
    {% endif %}
  </div>
</section>
{% endblock %}
