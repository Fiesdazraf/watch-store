{% extends "base.html" %}
{% load static humanize %}
{% block title %}ØªØ³ÙˆÛŒÙ‡â€ŒØ­Ø³Ø§Ø¨ Ù…Ù‡Ù…Ø§Ù† | ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø³Ø§Ø¹Øª{% endblock %}

{% block content %}
<section class="section pt-5">
  <div class="container">
    <h1 class="title is-4 mb-5">ğŸ§¾ ØªØ³ÙˆÛŒÙ‡â€ŒØ­Ø³Ø§Ø¨ Ù…Ù‡Ù…Ø§Ù†</h1>

    {% if items %}
    <div class="columns is-variable is-6">
      
      <!-- ğŸ› Cart Summary -->
      <div class="column is-5">
        <div class="box">
          <h2 class="title is-5 mb-4">Ø®Ù„Ø§ØµÙ‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯</h2>

          <table class="table is-fullwidth is-striped is-narrow">
            <thead>
              <tr>
                <th>Ù…Ø­ØµÙˆÙ„</th>
                <th class="has-text-centered">ØªØ¹Ø¯Ø§Ø¯</th>
                <th class="has-text-right">Ù‚ÛŒÙ…Øª</th>
              </tr>
            </thead>
            <tbody>
              {% for it in items %}
              <tr>
                <td>
                  <div class="is-flex is-align-items-center">
                    {% if it.product.primary_image %}
                      <figure class="image is-48x48 ml-3">
                        <img src="{{ it.product.primary_image.url }}" alt="{{ it.product.title }}">
                      </figure>
                    {% endif %}
                    <div>
                      <strong>{{ it.product.title }}</strong>
                      {% if it.variant_display %}
                        <div class="is-size-7 has-text-grey">({{ it.variant_display }})</div>
                      {% endif %}
                    </div>
                  </div>
                </td>
                <td class="has-text-centered">{{ it.quantity }}</td>
                <td class="has-text-right">{{ it.subtotal|intcomma }} ØªÙˆÙ…Ø§Ù†</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>

          <hr class="my-3">

          <div class="is-flex is-justify-content-space-between mb-2">
            <span>Ø¬Ù…Ø¹ Ø¬Ø²Ø¡:</span>
            <strong>{{ subtotal|intcomma }} ØªÙˆÙ…Ø§Ù†</strong>
          </div>

          {% if shipping_cost %}
          <div class="is-flex is-justify-content-space-between mb-2">
            <span>Ù‡Ø²ÛŒÙ†Ù‡ Ø§Ø±Ø³Ø§Ù„:</span>
            <strong>{{ shipping_cost|intcomma }} ØªÙˆÙ…Ø§Ù†</strong>
          </div>
          {% endif %}

          {% if discount_total %}
          <div class="is-flex is-justify-content-space-between mb-2 has-text-danger">
            <span>ØªØ®ÙÛŒÙ:</span>
            <strong>-{{ discount_total|intcomma }} ØªÙˆÙ…Ø§Ù†</strong>
          </div>
          {% endif %}

          <hr class="my-2">
          <div class="is-flex is-justify-content-space-between">
            <span>Ù…Ø¨Ù„Øº Ù†Ù‡Ø§ÛŒÛŒ:</span>
            <strong class="has-text-weight-bold has-text-primary">{{ total|intcomma }} ØªÙˆÙ…Ø§Ù†</strong>
          </div>
        </div>
      </div>

      <!-- ğŸ“¬ Guest Form -->
      <div class="column is-7">
        <div class="box">
          <h2 class="title is-5 mb-4">Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø§Ø±Ø³Ø§Ù„ Ø³ÙØ§Ø±Ø´</h2>
          <form method="post" novalidate>
            {% csrf_token %}

            <!-- Full name -->
            <div class="field">
              <label class="label">Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ</label>
              <div class="control has-icons-left">
                {{ form.full_name }}
                <span class="icon is-small is-left"><i class="fas fa-user"></i></span>
              </div>
              {% for e in form.full_name.errors %}
                <p class="help is-danger">{{ e }}</p>
              {% endfor %}
            </div>

            <!-- Phone -->
            <div class="field">
              <label class="label">Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³</label>
              <div class="control has-icons-left">
                {{ form.phone }}
                <span class="icon is-small is-left"><i class="fas fa-phone"></i></span>
              </div>
              {% for e in form.phone.errors %}
                <p class="help is-danger">{{ e }}</p>
              {% endfor %}
            </div>

            <!-- Address lines -->
            <div class="field">
              <label class="label">Ø¢Ø¯Ø±Ø³</label>
              <div class="control">{{ form.line1 }}</div>
              {% for e in form.line1.errors %}
                <p class="help is-danger">{{ e }}</p>
              {% endfor %}
            </div>

            <div class="field">
              <div class="control">{{ form.line2 }}</div>
              {% for e in form.line2.errors %}
                <p class="help is-danger">{{ e }}</p>
              {% endfor %}
            </div>

            <!-- City / Province -->
            <div class="columns">
              <div class="column">
                <div class="field">
                  <label class="label">Ø´Ù‡Ø±</label>
                  <div class="control">{{ form.city }}</div>
                </div>
              </div>
              <div class="column">
                <div class="field">
                  <label class="label">Ø§Ø³ØªØ§Ù†</label>
                  <div class="control">{{ form.province }}</div>
                </div>
              </div>
            </div>

            <!-- Postal code / Country -->
            <div class="columns">
              <div class="column">
                <div class="field">
                  <label class="label">Ú©Ø¯ Ù¾Ø³ØªÛŒ</label>
                  <div class="control">{{ form.postal_code }}</div>
                </div>
              </div>
              <div class="column">
                <div class="field">
                  <label class="label">Ú©Ø´ÙˆØ±</label>
                  <div class="control">{{ form.country }}</div>
                </div>
              </div>
            </div>

            <!-- Notes -->
            <div class="field">
              <label class="label">ÛŒØ§Ø¯Ø¯Ø§Ø´Øª (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)</label>
              <div class="control">
                <textarea name="notes" class="textarea" placeholder="Ø¯Ø± ØµÙˆØ±Øª Ù†ÛŒØ§Ø² ØªÙˆØ¶ÛŒØ­Ø§Øª Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯..."></textarea>
              </div>
            </div>

            <!-- Submit -->
            <div class="field mt-5">
              <div class="control">
                <button class="button is-primary is-fullwidth is-medium" type="submit">
                  <span class="icon"><i class="fas fa-check"></i></span>
                  <span>Ø«Ø¨Øª Ùˆ Ø§Ø¯Ø§Ù…Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª</span>
                </button>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>

    {% else %}
      <div class="notification is-warning has-text-centered py-6">
        <p class="is-size-5 mb-3">Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø´Ù…Ø§ Ø®Ø§Ù„ÛŒ Ø§Ø³Øª ğŸ˜•</p>
        <a href="{% url 'catalog:product_list' %}" class="button is-link is-light">Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ÙØ±ÙˆØ´Ú¯Ø§Ù‡</a>
      </div>
    {% endif %}
  </div>
</section>
{% endblock %}
