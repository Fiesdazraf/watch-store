{% extends "base.html" %}
{% load widget_tweaks %}
{% block title %}
  {% if form.instance.pk %}ویرایش آدرس | Watch-Store{% else %}افزودن آدرس جدید | Watch-Store{% endif %}
{% endblock %}

{% block content %}
<section class="section is-medium">
  <div class="container" style="max-width: 820px;">

    <div class="box" style="box-shadow:0 0 25px rgba(0,0,0,0.08); border-top:3px solid #c9a227;">
      <header class="has-text-centered mb-5">
        <span class="icon is-large" style="color:#c9a227;">
          <i class="fas fa-map-marked-alt fa-2x"></i>
        </span>
        <h1 class="title is-4 mt-2">
          {% if form.instance.pk %}ویرایش آدرس{% else %}افزودن آدرس جدید{% endif %}
        </h1>
      </header>

      {% if form.non_field_errors %}
        <article class="message is-danger mb-5">
          <div class="message-body">
            {{ form.non_field_errors }}
          </div>
        </article>
      {% endif %}

      <form method="post" novalidate>
        {% csrf_token %}
        <div class="columns is-multiline">

          <!-- Full name -->
          <div class="column is-12-tablet is-6-desktop">
            <div class="field">
              <label class="label" for="{{ form.full_name.id_for_label }}">نام گیرنده</label>
              <div class="control has-icons-left">
                {{ form.full_name|add_class:"input"|attr:"placeholder:مثلاً علی رضایی"|attr:"autocomplete:name" }}
                <span class="icon is-small is-left"><i class="fas fa-user"></i></span>
              </div>
              {% if form.full_name.errors %}
                <p class="help is-danger">{{ form.full_name.errors|striptags }}</p>
              {% endif %}
            </div>
          </div>

          <!-- Phone -->
          <div class="column is-12-tablet is-6-desktop">
            <div class="field">
              <label class="label" for="{{ form.phone_number.id_for_label }}">تلفن</label>
              <div class="control has-icons-left">
                {{ form.phone_number|add_class:"input"|attr:"placeholder:+98 912 000 0000"|attr:"dir:ltr"|attr:"inputmode:tel"|attr:"autocomplete:tel" }}
                <span class="icon is-small is-left"><i class="fas fa-phone"></i></span>
              </div>
              {% if form.phone_number.errors %}
                <p class="help is-danger">{{ form.phone_number.errors|striptags }}</p>
              {% endif %}
            </div>
          </div>

          <!-- Address lines -->
          <div class="column is-12">
            <div class="field">
              <label class="label" for="{{ form.line1.id_for_label }}">آدرس (خط ۱)</label>
              <div class="control">
                {{ form.line1|add_class:"input"|attr:"placeholder:خیابان، پلاک، واحد"|attr:"dir:rtl" }}
              </div>
              {% if form.line1.errors %}
                <p class="help is-danger">{{ form.line1.errors|striptags }}</p>
              {% endif %}
            </div>
          </div>

          <div class="column is-12">
            <div class="field">
              <label class="label" for="{{ form.line2.id_for_label }}">آدرس (خط ۲)</label>
              <div class="control">
                {{ form.line2|add_class:"input"|attr:"placeholder:طبقه، برج، توضیحات تکمیلی (اختیاری)"|attr:"dir:rtl" }}
              </div>
              {% if form.line2.errors %}
                <p class="help is-danger">{{ form.line2.errors|striptags }}</p>
              {% endif %}
            </div>
          </div>

          <!-- City / Province / Postal -->
          <div class="column is-12-tablet is-4-desktop">
            <div class="field">
              <label class="label" for="{{ form.city.id_for_label }}">شهر</label>
              <div class="control">
                {{ form.city|add_class:"input"|attr:"placeholder:مثلاً تهران" }}
              </div>
              {% if form.city.errors %}
                <p class="help is-danger">{{ form.city.errors|striptags }}</p>
              {% endif %}
            </div>
          </div>

          <div class="column is-12-tablet is-4-desktop">
            <div class="field">
              <label class="label" for="{{ form.province.id_for_label }}">استان</label>
              <div class="control">
                {{ form.province|add_class:"input"|attr:"placeholder:مثلاً البرز" }}
              </div>
              {% if form.province.errors %}
                <p class="help is-danger">{{ form.province.errors|striptags }}</p>
              {% endif %}
            </div>
          </div>

          <div class="column is-12-tablet is-4-desktop">
            <div class="field">
              <label class="label" for="{{ form.postal_code.id_for_label }}">کدپستی</label>
              <div class="control has-icons-left">
                {{ form.postal_code|add_class:"input"|attr:"placeholder:مثلاً 1234567890"|attr:"dir:ltr"|attr:"inputmode:numeric" }}
                <span class="icon is-small is-left"><i class="fas fa-mail-bulk"></i></span>
              </div>
              {% if form.postal_code.errors %}
                <p class="help is-danger">{{ form.postal_code.errors|striptags }}</p>
              {% endif %}
            </div>
          </div>

          <!-- Country -->
          <div class="column is-12-tablet is-6-desktop">
            <div class="field">
              <label class="label" for="{{ form.country.id_for_label }}">کشور</label>
              <div class="control">
                <div class="select is-fullwidth">
                  {{ form.country }}
                </div>
              </div>
              {% if form.country.errors %}
                <p class="help is-danger">{{ form.country.errors|striptags }}</p>
              {% endif %}
            </div>
          </div>

          <!-- Default -->
          <div class="column is-12-tablet is-6-desktop is-flex is-align-items-end">
            <div class="field">
              <label class="checkbox">
                {{ form.is_default }} <span>تنظیم به عنوان آدرس پیش‌فرض</span>
              </label>
              <p class="help is-size-7 mt-1">در هر زمان فقط یک آدرس پیش‌فرض می‌توانید داشته باشید.</p>
            </div>
          </div>
        </div>

        <div class="buttons is-centered mt-5">
          <button class="button is-primary is-medium" type="submit" style="background-color:#c9a227;">
            <span class="icon"><i class="fas fa-save"></i></span>
            <span>ذخیره آدرس</span>
          </button>
          <a href="{% url 'customers:address_list' %}" class="button is-light is-medium">
            <span class="icon"><i class="fas fa-times"></i></span>
            <span>انصراف</span>
          </a>
        </div>
      </form>

    </div>

  </div>
</section>
{% endblock %}
