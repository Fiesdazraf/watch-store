{% extends "base.html" %}
{% block title %}آدرس‌های من | Watch-Store{% endblock %}

{% block content %}
<section class="section pt-5">
  <div class="container">

    <!-- Header -->
    <div class="is-flex is-justify-content-space-between is-align-items-center mb-5">
      <h1 class="title is-4 mb-0">آدرس‌های من</h1>
      <a href="{% url 'customers:address_create' %}" class="button is-primary is-medium" style="background-color:#c9a227;">
        <span class="icon"><i class="fas fa-plus"></i></span>
        <span>افزودن آدرس جدید</span>
      </a>
    </div>

    <!-- Address cards -->
    {% if addresses %}
      <div class="columns is-multiline">
        {% for a in addresses %}
          <div class="column is-12-tablet is-6-desktop">
            <div class="box"
                 style="{% if a.default_shipping or a.default_billing %}border:2px solid #c9a227;{% endif %} box-shadow:0 0 15px rgba(0,0,0,0.05); border-radius:10px;">
              
              <div class="is-flex is-justify-content-space-between is-align-items-center mb-3">
                <p class="is-size-6 has-text-weight-semibold">
                  <span class="icon mr-1"><i class="fas fa-map-marker-alt"></i></span>
                  {{ a.full_name|default:"بدون نام" }}
                </p>
                <div class="tags">
                  {% if a.default_shipping %}
                    <span class="tag is-success is-light">پیش‌فرض ارسال</span>
                  {% endif %}
                  {% if a.default_billing %}
                    <span class="tag is-warning is-light">پیش‌فرض صورتحساب</span>
                  {% endif %}
                </div>
              </div>

              <div class="content is-size-6 has-text-grey-dark">
                {% if a.phone_number or a.phone %}
                  <p><i class="fas fa-phone ml-1"></i> <span dir="ltr">{{ a.phone_number|default:a.phone }}</span></p>
                {% endif %}
                <p dir="rtl">
                  {{ a.line1 }}{% if a.line2 %}، {{ a.line2 }}{% endif %}
                </p>
                <p>
                  {{ a.city }}
                  {% if a.province %}، {{ a.province }}{% endif %}
                  {% if a.postal_code %}، <span dir="ltr">{{ a.postal_code }}</span>{% endif %}
                </p>
                <p>{{ a.country }}</p>
              </div>

              <!-- Actions -->
              <div class="buttons mt-4 is-flex is-flex-wrap-wrap" style="gap:0.5rem;">
                <a href="{% url 'customers:address_update' a.pk %}" class="button is-link is-light">
                  <span class="icon"><i class="fas fa-edit"></i></span>
                  <span>ویرایش</span>
                </a>

                <form method="post" action="{% url 'customers:address_delete' a.pk %}">
                  {% csrf_token %}
                  <button type="submit" class="button is-danger is-light">
                    <span class="icon"><i class="fas fa-trash-alt"></i></span>
                    <span>حذف</span>
                  </button>
                </form>

                <a href="{% url 'customers:set_default_address' a.pk 'shipping' %}" class="button is-light">
                  <span class="icon"><i class="fas fa-truck"></i></span>
                  <span>پیش‌فرض ارسال</span>
                </a>

                <a href="{% url 'customers:set_default_address' a.pk 'billing' %}" class="button is-light">
                  <span class="icon"><i class="fas fa-file-invoice"></i></span>
                  <span>پیش‌فرض صورتحساب</span>
                </a>
              </div>

            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <!-- Empty state -->
      <div class="box has-text-centered">
        <span class="icon is-large mb-2" style="color:#c9a227;">
          <i class="fas fa-map-pin fa-2x"></i>
        </span>
        <p class="is-size-5 mb-3">هنوز آدرسی ثبت نکرده‌اید.</p>
        <a href="{% url 'customers:address_create' %}" class="button is-primary" style="background-color:#c9a227;">
          <span class="icon"><i class="fas fa-plus"></i></span>
          <span>افزودن آدرس جدید</span>
        </a>
      </div>
    {% endif %}

  </div>
</section>
{% endblock %}
