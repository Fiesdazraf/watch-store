{% extends "base.html" %}
{% load humanize %}
{% block title %}فاکتور {{ invoice.number }} | Watch-Store{% endblock %}

{% block content %}
<section class="section is-medium">
  <div class="container" style="max-width:900px;">

    <div class="box" style="box-shadow:0 0 25px rgba(0,0,0,0.05); border-top:3px solid #c9a227;">
      <div class="is-flex is-justify-content-space-between is-align-items-center mb-5">
        <h1 class="title is-4 mb-0">
          <span class="icon mr-1"><i class="fas fa-file-invoice-dollar"></i></span>
          فاکتور شماره {{ invoice.number }}
        </h1>
        <a class="button is-light" href="{% url 'backoffice:invoices_list' %}">
          <span class="icon"><i class="fas fa-arrow-right"></i></span>
          <span>بازگشت</span>
        </a>
      </div>

      <!-- Invoice Summary -->
      <div class="columns is-multiline">
        <div class="column is-12-tablet is-5-desktop">
          <div class="box" style="background:#fafafa;">
            <p><strong>وضعیت:</strong>
              <span class="tag 
                {% if invoice.status == 'paid' %}is-success
                {% elif invoice.status == 'unpaid' %}is-warning
                {% elif invoice.status == 'void' %}is-danger
                {% else %}is-light{% endif %}">
                {{ invoice.get_status_display }}
              </span>
            </p>
            <p><strong>مبلغ:</strong> {{ invoice.amount|floatformat:0|intcomma }} تومان</p>
            <p><strong>تاریخ صدور:</strong> {{ invoice.issued_at|date:"Y-m-d H:i" }}</p>
            {% if invoice.paid_at %}
              <p><strong>تاریخ پرداخت:</strong> {{ invoice.paid_at|date:"Y-m-d H:i" }}</p>
            {% endif %}
            {% if invoice.number %}
              <a class="button is-primary is-fullwidth mt-4" style="background-color:#c9a227;"
                 href="{% url 'invoices:invoice_pdf' invoice.number %}">
                <span class="icon"><i class="fas fa-download"></i></span>
                <span>دانلود PDF</span>
              </a>
            {% endif %}
          </div>
        </div>

        {% if invoice.order %}
        <div class="column is-12-tablet is-7-desktop">
          <div class="box" style="background:#fafafa;">
            <h2 class="title is-6 mb-3">جزئیات سفارش</h2>
            <p><strong>شماره سفارش:</strong> {{ invoice.order.number }}</p>
            <p><strong>مبلغ کل:</strong> {{ invoice.order.grand_total|floatformat:0|intcomma }} تومان</p>
            <p><strong>تاریخ ثبت:</strong> {{ invoice.order.placed_at|date:"Y-m-d H:i" }}</p>
          </div>
        </div>
        {% endif %}
      </div>
    </div>

  </div>
</section>
{% endblock %}
