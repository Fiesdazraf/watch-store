{# templates/catalog/_products_grid.html #}
{% load static humanize %}

<div id="products-grid" role="region" aria-live="polite">
  <div class="columns is-multiline">
    {% for product in products %}
      <div class="column is-6-tablet is-4-desktop is-3-widescreen">
        {% include "catalog/_product_card.html" with product=product %}
      </div>
    {% empty %}
      <div class="column is-12">
        <article class="message is-info">
          <div class="message-body">محصولی یافت نشد.</div>
        </article>
      </div>
    {% endfor %}
  </div>

  {% if is_paginated %}
    {% with qs=querystring|default:request.GET.urlencode %}
    <nav class="pagination is-centered mt-4" role="navigation" aria-label="pagination">
      {% if page_obj.has_previous %}
        <a class="pagination-previous"
           hx-get="?page={{ page_obj.previous_page_number }}{% if qs %}&{{ qs }}{% endif %}"
           hx-target="#products-grid"
           hx-push-url="true"
           aria-label="صفحه قبلی">قبلی</a>
      {% else %}
        <a class="pagination-previous" disabled>قبلی</a>
      {% endif %}

      {% if page_obj.has_next %}
        <a class="pagination-next"
           hx-get="?page={{ page_obj.next_page_number }}{% if qs %}&{{ qs }}{% endif %}"
           hx-target="#products-grid"
           hx-push-url="true"
           aria-label="صفحه بعدی">بعدی</a>
      {% else %}
        <a class="pagination-next" disabled>بعدی</a>
      {% endif %}

      <ul class="pagination-list" aria-hidden="false">
        <li><span class="pagination-ellipsis">صفحه {{ page_obj.number }} از {{ page_obj.paginator.num_pages }}</span></li>
      </ul>
    </nav>
    {% endwith %}
  {% endif %}
</div>
